# Vue 组件库

## 知识

1. JSX 是一种 JavaScript 的语法插件，最早运用于 react 架构中，可以当作一种模板语言使用。

目前很多 Vue 的组件库都大量使用了 JSX 的语法，对于工程化搭建，要以开发者的使用习惯优先，建议支持。

2. Vue 组件库有两种引入形态：

- 完整引入：一次性引入全部组件，使用 Vue.use 以 Vue 的插件的形式引入；
- 按需引入：按需引入，导出单个组件，使用 Vue.component 注册。

组件库的形态结构需要满足下面要求：

- 默认导出 Vue 插件；
- 每个组件可以单独导出。

## 样式

1. 组件库通常需要搭建一个 CSS 子工程，用于实现自己的类型系统。

2. 2020 年一种叫做 AtomicCSS 的组件风格横空出世，代表作就是 TailwindCSS。

从组件库开发角度讲，使用 Tailwind 提供的样式系统，可以很好地降低 UI 库的开发难度。**利用原子化风格，完全就可以高效完成样式的定制，未必一定需要定制一套语义化样式系统。**

3. UnoCSS

- [Github](https://github.com/unocss/unocss)

4. 原子 CSS 的好处：**基本常用的属性定义都可以通过简单的字符串拼装完成。**

注意：**UnoCSS 默认是按需生成方式，即只生成代码中使用过的样式。** 如果在 class 属性中使用变量，是无法分析变量的取值的，也就无法动态生成样式的。

为了解决这个问题，UnoCSS 提供了安全列表选项。也就是说，把样式定义中变量的取值添加到 Safelist 中去。这样 UnoCSS 就会根据 Safelist 生成样式了。

### 图标

1. 在 UnoCSS 中引入图标，只需要加载 @unocss/preset-icons 预设就可以了

2. [iconfy](https://icones.js.org/)网站中有上万个字体图标可以选择。

## 文档

1. 使用 Vitepress 创建一个文档网站。

Vitepress 是一款基于 Vite 的静态站点生成工具。

优势是：

- 使用 Markdown 语法；
- vitepress 是基于 vite 的；
- 直接运行 Vue 的代码。

通常情况下，开发组件可以在 vitepress 调试代码。

2. 什么是 Markdown 插槽？

```md
:::slot name
:::
```

## 组件的引入

1. 目前组件的按需引入的两个方法：

- 组件单独分包 + 按需导入 + babel-plugin-component ( 自动化按需引入)；
- ESModule + Treeshaking + 自动按需 import（unplugin-vue-components 自动化配置）

### 分包与摇树

1. 传统的解决方案就是将组件库分包导出，比如将组件库分为 List、Button、Card，用到哪个加载哪个，简单粗暴，不足之处：

- 需要了解软件包内部构造 例： import "ui/xxx" or import "ui/package/xxx"；
- 需要不断手工调整组件加载预注册。

结合 babel-plugin-component 可以解决包构造问题

```js
// 全部导入
const TrigonUI = require('trigon-ui');

// 单独导入
const Button = require('trigon-ui/button');

// 转换前
const { Button } = require('trigon-ui');
// 转换后
const Button = require('trigon-ui/button');
```

3. 随着 esmodule 成为前端开发的主流，利用静态编译，在编译阶段就可以判断需要导入哪些包。

### 实现分包导出

> unplugin-vue-component 的自动导入

1. 分包导出相当于将组件库形成无数各子软件包，软件包必须满足一下要求：

- 文件名即组件名；
- 独立的 package.json 定义，包含 esm 和 umd 的入口定义；
- 每个组件必须以 Vue 插件形式进行加载；
- 每个软件包还需要有单独的 css 导出。

2. 编写分包导出脚本

默认导出方式是通过配置 vite.config.ts 的 build 属性完成。但是在分包导出的时候需要每个组件都分别配置自己的配置文件，而且需要由程序自动读取组件文件夹，根据文件夹的名字遍历打包，还需要为每个子组件包配上一个 package.json 文件。

## Icons

> [docs](https://icones.js.org/)

## Github

1. 在 Github 上的项目往往都采用敏捷方式管理。

### issue - 问题管理

1. 无论项目的管理方式是不是敏捷的，问题管理系统是一定需要的。

2. 问题管理是四大管理模式之一，可以将项目开发过程当做下面的过程：

- 挖掘问题；
- 表达问题；
- 归结问题；
- 处理问题。

**一个项目就是将一个大问题分拆，并各个击破的过程。**

3. 在项目中的问题大概可以归纳为以下几类：

- 任务 - 待完成任务；
- bug 缺陷；
- feature 新特性；
- 问题：
  - 功能建议；
  - 项目中不能计划或不期望发生的问题和困难。

4. 可以在 issue 中不断讨论问题，链接代码、指派给相关人，直到问题最终解决，然后 close 问题，**这就是问题管理系统。**

### Project - 项目

项目是在一定约束的条件下（时间、资源（人力、设备）），完成一个明确的一次性任务。很多人都会把代码称之为项目，这个大错而特错。举个例子：Vue 代码不是一个项目，在八月底完成 Vue1.0 版本的发布才是一个项目。

1. 为了完成项目，需要确定项目的目标，拆分(break down)成 task issue。在完成过程中：

- 不断测量；
- 不断平衡质量、进度、成本；

**促使项目在约定时间用合理的成本达成目标，即项目管理。**

2. 在 GitHub 上使用敏捷的方式管理项目。在问题管理的基础上，一次项目，如完成某一个版本，可以看做是解决一部分特定的 issue。

3. 在 Github 中使用 Project 功能来实现这个功能。这个功能主要的理论根源来自于敏捷开发的看板模式。

tips: 看板模式，源于丰田的精益生产，是一种可视化的流程管理系统。

4. 使用看板管理项目需要三步：

- 创建项目：确定目标；
- 将相关 issue 纳入项目中：拆分任务、**划分任务边界**；
- 分配任务到个人；
- 看板跟踪项目进度。

#### 使用

1. 创建项目，组织或个人目录中创建项目。

2. 在仓库中将 project 挂载到当前项目。

3. 将 issue 纳入项目。

根据项目目标划定具体的功能。**把目标分解和确定开发边界。**

举个例子，开发 MVP 1.0 版本：

- 目标是：完善工程化闭环；
- 添加典型组件。

**需要将功能 issue 和 bug issue 添加到项目中。**

4. 分配项目，**评估 issue 的重要度和复杂度，确定开发的有限顺序。**

5. 分配任务到开发者，或者开发者自觉认领。开源团队这个过程一般都是认领的比较多。

6. 使用看板功能跟踪项目过程。

## 要点

1. 在软件工程中有这样一个概念：**一个完整的软件是文档和代码的组合体，** 不知道如何使用的代码是没有任何价值的。**项目文档的建设工作应该越早越好。**

2. markdown 插槽

```makefile
::: slot name
:::
```

3. 建议：用 vitepress 调试代码，这种方式非常理想：

- 方便调试；
- 同步编写文档。

4. Vue3 默认的包是不支持模板编译功能的，即不能使用 template 语法。

在 Vue3.0 中编译功能推荐在构建阶段完成，而不是放到浏览器中运行。如果希望在浏览器中的话，可以选择 ./node_modules/vue/dist/vue.global.js 这个包。

5. git 提交时，默认的 git 修改是忽略大小写的，需要改一下 git 的配置

```sh
git config core.ignorecase false
```

6. 开发完成不是完成任务，代码的 review 和关闭项目需要第三者确认才有意义。

7. 随着前端技术的复杂化，**需要创建独立的前端工程，需要模块化和组件化来提高代码的可读性，需要自动化进行代码额 Bundle、压缩、丑化，需要规范化检查工具控制代码质量。**

8. 前端工程的四化：

- 规范化；
- 模块化；
- 组件化；
- 自动化。

9. 前端工程的变迁：

- 工作流时代：Grunt, Gulp 生态；
- Bundle 时代：webpack 生态；
- Bundless 时代：Vite 生态。

工作流时代主要的核心是自动化和优化工作流。相当于给前端任务添加了一套高级的脚本。

Bundle 时代是以模块打包机为基础的，通过不同的 Plugin 与 Loader 实现不同功能。这种方式有一个致命问题就是性能。因为一个模块变化必须重新打包，虽然可以用缓存和并行处理提高性能。

随着浏览器对 ES 模块的支持，新的 Bundless 时代到来。Vite 横空出世，Vite 可以利用浏览器对 ES 模块的支持，让前端可以通不打包的方式调试。这样就可以极大提高研发效率。其实更激进的方式是生产环境也使用 ESM，包括第三方库也是通过 ESM 组织。但这种方式还不太成熟。

10. 一个团队的架构组就是给全组人进行踩坑，他们会尝试不同的路线，尝试不稳定的版本，做 Pre 的性能测试，编写 Pilot Source。应该说他们就是项目的荒野求生之路。

做这种工作的人需要有坚强的意志和奉献的态度。如果你能够做这样的工作，是别人对你的巨大肯定。你可以通过这个机会来很好地提高你的团队领导力。
